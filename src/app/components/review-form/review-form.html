<div class="review-form-card">
  <h3>Laisser un avis</h3>

  <form [formGroup]="reviewForm" (ngSubmit)="onSubmit()">
    <div class="rating-input">
      <label>Note *</label>
      <div class="star-selector">
        @for (star of [1, 2, 3, 4, 5]; track star) {
          <span 
            class="star"
            [class.filled]="star <= getDisplayRating()"
            [class.selected]="star <= selectedRating()"
            (click)="setRating(star)"
            (mouseenter)="onStarHover(star)"
            (mouseleave)="onStarLeave()"
          >
            ★
          </span>
        }
      </div>
      @if (selectedRating() > 0) {
        <span class="rating-label">{{ selectedRating() }} / 5</span>
      }
    </div>

    <div class="form-group">
      <label for="comment">Commentaire (optionnel)</label>
      <textarea 
        id="comment" 
        formControlName="comment"
        placeholder="Partagez votre expérience..."
        rows="4"
        maxlength="500"
      ></textarea>
      <span class="char-count">
        {{ reviewForm.value.comment?.length || 0 }} / 500
      </span>
    </div>

    @if (errorMessage()) {
      <div class="alert alert-error">
        {{ errorMessage() }}
      </div>
    }

    @if (successMessage()) {
      <div class="alert alert-success">
        {{ successMessage() }}
      </div>
    }

    <button 
      type="submit" 
      class="btn btn-primary"
      [disabled]="isLoading() || reviewForm.invalid"
    >
      @if (isLoading()) {
        Publication en cours...
      } @else {
        Publier l'avis
      }
    </button>
  </form>
</div>
